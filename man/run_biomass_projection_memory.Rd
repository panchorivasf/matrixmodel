% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_biomass_projection_memory.R
\name{run_biomass_projection_memory}
\alias{run_biomass_projection_memory}
\title{Run Forest Biomass Projection Model with Memory-Efficient Processing}
\usage{
run_biomass_projection_memory(
  t1_all,
  dffinal,
  model_m_path,
  model_u_path,
  model_r_path,
  years = 300,
  plot_ids = NULL,
  cores = (detectCores() - 1)
)
}
\arguments{
\item{t1_all}{A data frame containing initial forest inventory data for all plots.
Must include a 'PlotID' column and species/diameter matrix columns.}

\item{dffinal}{A data frame containing diameter at breast height (DBH) reference
data, including 'DGP' (Diameter Growth Pattern) and 'DBH' columns, and 'PlotID'
for distinguishing DRC plots from other plots.}

\item{model_m_path}{Character string. File path to the mortality model (RDS file).}

\item{model_u_path}{Character string. File path to the upgrade/growth model (RDS file).}

\item{model_r_path}{Character string. File path to the recruitment model (RDS file).}

\item{years}{Integer. Number of years to project forward. Default is 300.}

\item{plot_ids}{Character vector. Optional subset of PlotIDs to process. If NULL
(default), all plots in t1_all are processed.}

\item{cores}{Integer. Number of CPU cores to use for parallel processing. Default
is detectCores() - 1.}
}
\value{
A named list containing five elements:
  \describe{
    \item{all_preds}{Data frame with detailed predictions for each plot, species,
      and year, including biomass (B), number of trees (N), recruitment basal area
      (rec_BA), upgrade basal area (up_BA), and mortality basal area (mort_BA)}
    \item{all_summary}{Data frame with summary statistics for each plot and year}
    \item{summary_by_year}{Data frame with aggregated statistics by year across
      all plots, including means, standard deviations, standard errors, and 95%
      confidence intervals}
    \item{species_year}{Data frame with totals aggregated by species (SPCD) and year}
    \item{plot_species_year}{Data frame with totals aggregated by plot, species,
      and year}
  }
}
\description{
Executes a forest biomass projection model using mortality, upgrade, and recruitment
models to simulate forest growth over multiple years. The function processes plots
in parallel and returns comprehensive results including individual predictions,
summaries, and aggregated data by species and year.
}
\details{
This function implements a forest growth projection model that:
\itemize{
  \item Uses separate DBH reference values for DRC plots vs. other plots
  \item Applies mortality, upgrade, and recruitment models iteratively
  \item Processes plots in parallel for computational efficiency
  \item Generates comprehensive output summaries at multiple aggregation levels
}

The function requires the tidyverse, ranger, and doParallel packages, and depends
on helper functions: prepare_pred_vector(), update_predictions(),
extract_outputs(), and summarize_predictions().
}
\examples{
\dontrun{
# Load required data
t1_data <- read.csv("forest_inventory_t1.csv")
dbh_reference <- read.csv("dbh_reference.csv")

# Run full projection for 100 years
results <- run_biomass_projection_memory(
  t1_all = t1_data,
  dffinal = dbh_reference,
  model_m_path = "models/mortality_model.rds",
  model_u_path = "models/upgrade_model.rds",
  model_r_path = "models/recruitment_model.rds",
  years = 100,
  cores = 4
)

# Run projection for subset of plots
subset_results <- run_biomass_projection_memory(
  t1_all = t1_data,
  dffinal = dbh_reference,
  model_m_path = "models/mortality_model.rds",
  model_u_path = "models/upgrade_model.rds",
  model_r_path = "models/recruitment_model.rds",
  years = 50,
  plot_ids = c("Plot001", "Plot002", "DRC_Plot003"),
  cores = 2
)

# Access results
biomass_trends <- results$summary_by_year
species_composition <- results$species_year
}

}
\seealso{
\code{\link{prepare_pred_vector}}, \code{\link{update_predictions}},
\code{\link{extract_outputs}}, \code{\link{summarize_predictions}}
}
